<!DOCTYPE html>
<html lang="en" >
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Reseller Panel with Roles</title>
  <style>
    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      background: #121212;
      color: #eee;
      margin: 0; padding: 0;
    }
    #app {
      max-width: 1000px;
      margin: 30px auto;
      padding: 20px;
      position: relative;
    }
    header {
      font-size: 32px;
      font-weight: 900;
      color: #5af;
      text-align: center;
      margin-bottom: 30px;
      position: relative;
    }
    #auth-buttons {
      position: absolute;
      top: 20px;
      right: 20px;
    }
    button {
      background: #5af;
      border: none;
      color: #121212;
      font-weight: 700;
      padding: 10px 16px;
      margin-left: 10px;
      border-radius: 8px;
      cursor: pointer;
      transition: background 0.3s;
    }
    button:hover {
      background: #3a7fff;
    }
    nav {
      display: flex;
      gap: 16px;
      justify-content: center;
      margin-bottom: 20px;
    }
    nav button {
      background: #1e1e1e;
      border: none;
      color: #aaa;
      padding: 12px 20px;
      font-weight: 700;
      font-size: 16px;
      border-radius: 8px 8px 0 0;
      cursor: pointer;
      transition: 0.3s;
    }
    nav button.active {
      background: #5af;
      color: #121212;
    }
    nav button:hover:not(.active) {
      background: #333;
      color: #5af;
    }
    section {
      background: #1e1e1e;
      padding: 25px 30px;
      border-radius: 0 12px 12px 12px;
      box-shadow: 0 0 25px #222 inset;
      display: none;
    }
    section.active {
      display: block;
    }
    h2 {
      margin-top: 0;
      margin-bottom: 20px;
      color: #5af;
    }
    table {
      width: 100%;
      border-collapse: collapse;
      background: #222;
      border-radius: 8px;
      overflow: hidden;
    }
    th, td {
      padding: 12px 10px;
      text-align: center;
      border-bottom: 1px solid #333;
    }
    th {
      background: #333;
    }
    tbody tr:hover {
      background: #2f2f2f;
    }
    button.action-btn {
      background: #5af;
      border: none;
      padding: 6px 12px;
      color: #121212;
      font-weight: 700;
      border-radius: 6px;
      cursor: pointer;
      margin: 0 2px;
    }
    button.action-btn:hover {
      background: #3a7fff;
    }
    form label {
      display: block;
      margin-top: 14px;
      font-weight: 700;
    }
    form input[type="text"], form input[type="number"], form input[type="password"] {
      width: 100%;
      padding: 10px;
      border-radius: 6px;
      border: none;
      background: #333;
      color: #eee;
      font-size: 16px;
      margin-top: 6px;
    }
    form input[type="submit"] {
      margin-top: 24px;
      background: #5af;
      color: #121212;
      border: none;
      padding: 14px;
      border-radius: 8px;
      cursor: pointer;
      font-weight: 700;
      font-size: 16px;
      width: 100%;
    }
    form input[type="submit"]:hover {
      background: #3a7fff;
    }
    .flex-row {
      display: flex;
      gap: 12px;
      justify-content: center;
    }
    .edit-input {
      width: 100px;
      padding: 6px 8px;
      font-size: 14px;
      border-radius: 5px;
      border: none;
      background: #444;
      color: #eee;
    }
    .modal-overlay {
      position: fixed;
      inset: 0;
      background: rgba(0,0,0,0.75);
      display: none;
      align-items: center;
      justify-content: center;
      z-index: 9999;
    }
    .modal-overlay.active {
      display: flex;
    }
    .modal {
      background: #222;
      padding: 30px 30px 20px;
      border-radius: 12px;
      width: 320px;
      box-shadow: 0 0 20px #111;
      color: #eee;
      position: relative;
    }
    .modal h3 {
      margin-top: 0;
      margin-bottom: 20px;
      color: #5af;
      text-align: center;
    }
    .modal .close-btn {
      position: absolute;
      top: 10px; right: 12px;
      background: transparent;
      border: none;
      font-size: 28px;
      color: #888;
      cursor: pointer;
    }
    .modal .close-btn:hover {
      color: #5af;
    }
    .view-only input,
    .view-only button.action-btn,
    .view-only form input[type="submit"] {
      pointer-events: none;
      opacity: 0.5;
    }
  </style>
</head>
<body>
  <div id="app">
    <header>
      Reseller Panel
      <div id="auth-buttons">
        <button id="reseller-login-btn">Reseller Login</button>
        <button id="reseller-signup-btn">Reseller Sign Up</button>
        <button id="admin-login-btn">Admin Login</button>
      </div>
    </header>

    <nav>
      <button class="tab-btn active" data-tab="products">Products</button>
      <button class="tab-btn" data-tab="keys">License Keys</button>
      <button class="tab-btn" data-tab="settings">Settings</button>
    </nav>

    <section id="products" class="active">
      <h2>Products</h2>
      <table id="products-table">
        <thead>
          <tr><th>ID</th><th>Name</th><th>Price ($)</th><th>Stock</th><th>Actions</th></tr>
        </thead>
        <tbody></tbody>
      </table>
      <h3 style="margin-top: 30px;">Add New Product</h3>
      <form id="add-product-form">
        <label for="product-name">Name</label>
        <input type="text" id="product-name" placeholder="Product name" required />
        <label for="product-price">Price ($)</label>
        <input type="number" id="product-price" placeholder="Price" min="0" step="0.01" required />
        <label for="product-stock">Stock</label>
        <input type="number" id="product-stock" placeholder="Stock quantity" min="0" step="1" required />
        <input type="submit" value="Add Product" />
      </form>
    </section>

    <section id="keys">
      <h2>License Keys</h2>
      <table id="keys-table">
        <thead>
          <tr><th>ID</th><th>Product ID</th><th>Key</th><th>Used</th><th>Actions</th></tr>
        </thead>
        <tbody></tbody>
      </table>
      <h3 style="margin-top: 30px;">Add New License Key</h3>
      <form id="add-key-form">
        <label for="key-product-id">Product ID</label>
        <input type="number" id="key-product-id" placeholder="Product ID" min="1" required />
        <label for="license-key">License Key</label>
        <input type="text" id="license-key" placeholder="License key" required />
        <label><input type="checkbox" id="license-used" /> Used</label>
        <input type="submit" value="Add License Key" />
      </form>
    </section>

    <section id="settings">
      <h2>Settings</h2>
      <form id="settings-form">
        <label for="reseller-name">Reseller Name</label>
        <input type="text" id="reseller-name" placeholder="Your name" />
        <label for="reseller-email">Email</label>
        <input type="text" id="reseller-email" placeholder="Your email" />
        <label for="payment-method">Payment Method</label>
        <input type="text" id="payment-method" placeholder="Payment method" />
        <input type="submit" value="Save Settings" />
      </form>
    </section>
  </div>

  <!-- Reseller Login Modal -->
  <div id="reseller-login-modal" class="modal-overlay">
    <div class="modal">
      <button class="close-btn" id="reseller-login-close">&times;</button>
      <h3>Reseller Login</h3>
      <form id="reseller-login-form">
        <label for="reseller-login-username">Username</label>
        <input type="text" id="reseller-login-username" required />
        <label for="reseller-login-password">Password</label>
        <input type="password" id="reseller-login-password" required />
        <input type="submit" value="Login" />
      </form>
      <p style="text-align:center; margin-top: 10px; color: #aaa;">
        Don't have an account? <button id="show-reseller-signup" style="background:none; border:none; color:#5af; cursor:pointer; font-weight:bold;">Sign Up</button>
      </p>
    </div>
  </div>

  <!-- Reseller Signup Modal -->
  <div id="reseller-signup-modal" class="modal-overlay">
    <div class="modal">
      <button class="close-btn" id="reseller-signup-close">&times;</button>
      <h3>Reseller Sign Up</h3>
      <form id="reseller-signup-form">
        <label for="reseller-signup-username">Username</label>
        <input type="text" id="reseller-signup-username" required />
        <label for="reseller-signup-password">Password</label>
        <input type="password" id="reseller-signup-password" required />
        <input type="submit" value="Sign Up" />
      </form>
      <p style="text-align:center; margin-top: 10px; color: #aaa;">
        Already have an account? <button id="show-reseller-login" style="background:none; border:none; color:#5af; cursor:pointer; font-weight:bold;">Login</button>
      </p>
    </div>
  </div>

  <!-- Admin Login Modal -->
  <div id="admin-login-modal" class="modal-overlay">
    <div class="modal">
      <button class="close-btn" id="admin-login-close">&times;</button>
      <h3>Admin Login</h3>
      <form id="admin-login-form">
        <label for="admin-login-username">Username</label>
        <input type="text" id="admin-login-username" required />
        <label for="admin-login-password">Password</label>
        <input type="password" id="admin-login-password" required />
        <input type="submit" value="Login" />
      </form>
    </div>
  </div>

<script>
  // Tabs
  const tabs = document.querySelectorAll('nav .tab-btn');
  const sections = document.querySelectorAll('section');

  tabs.forEach(tab => {
    tab.addEventListener('click', () => {
      tabs.forEach(t => t.classList.remove('active'));
      tab.classList.add('active');
      sections.forEach(sec => sec.classList.remove('active'));
      document.getElementById(tab.dataset.tab).classList.add('active');
    });
  });

  // Storage keys
  const STORAGE_PRODUCTS = 'reseller_products';
  const STORAGE_KEYS = 'reseller_license_keys';
  const STORAGE_SETTINGS = 'reseller_settings';
  const STORAGE_RESELLERS = 'reseller_users'; // resellers
  const STORAGE_CURRENT_USER = 'reseller_current_user'; // logged in user
  const STORAGE_ADMIN_USER = 'reseller_admin_user'; // logged in admin

  // Hardcoded admin credentials for demo
  const ADMIN_CREDENTIALS = {username: 'admin', password: 'admin123'};

  // Data
  let products = JSON.parse(localStorage.getItem(STORAGE_PRODUCTS)) || [
    {id: 1, name: 'Ultimate Cheat', price: 50, stock: 100},
    {id: 2, name: 'Stealth Hack', price: 35, stock: 60},
  ];
  let licenseKeys = JSON.parse(localStorage.getItem(STORAGE_KEYS)) || [
    {id: 1, productId: 1, key: 'ABC123-ULTIMATE', used: false},
    {id: 2, productId: 2, key: 'STEALTH-KEY-999', used: true},
  ];
  let settings = JSON.parse(localStorage.getItem(STORAGE_SETTINGS)) || {
    resellerName: '',
    resellerEmail: '',
    paymentMethod: ''
  };
  let resellers = JSON.parse(localStorage.getItem(STORAGE_RESELLERS)) || [];
  let currentUser = JSON.parse(localStorage.getItem(STORAGE_CURRENT_USER)) || null;
  let adminUser = JSON.parse(localStorage.getItem(STORAGE_ADMIN_USER)) || null;

  // Save helpers
  function saveProducts() {
    localStorage.setItem(STORAGE_PRODUCTS, JSON.stringify(products));
  }
  function saveKeys() {
    localStorage.setItem(STORAGE_KEYS, JSON.stringify(licenseKeys));
  }
  function saveSettings() {
    localStorage.setItem(STORAGE_SETTINGS, JSON.stringify(settings));
  }
  function saveResellers() {
    localStorage.setItem(STORAGE_RESELLERS, JSON.stringify(resellers));
  }
  function saveCurrentUser() {
    if(currentUser)
      localStorage.setItem(STORAGE_CURRENT_USER, JSON.stringify(currentUser));
    else
      localStorage.removeItem(STORAGE_CURRENT_USER);
  }
  function saveAdminUser() {
    if(adminUser)
      localStorage.setItem(STORAGE_ADMIN_USER, JSON.stringify(adminUser));
    else
      localStorage.removeItem(STORAGE_ADMIN_USER);
  }

  // Check roles
  function isAdmin() {
    return adminUser !== null;
  }
  function isReseller() {
    return currentUser !== null;
  }

  // Render tables and forms
  const productsTableBody = document.querySelector('#products-table tbody');
  const keysTableBody = document.querySelector('#keys-table tbody');

  function renderProducts() {
    productsTableBody.innerHTML = '';
    products.forEach(product => {
      const tr = document.createElement('tr');
      tr.innerHTML = `
        <td>${product.id}</td>
        <td>${isAdmin() ? `<input class="edit-input" type="text" value="${product.name}" data-id="${product.id}" data-field="name">` : product.name}</td>
        <td>${isAdmin() ? `<input class="edit-input" type="number" min="0" step="0.01" value="${product.price}" data-id="${product.id}" data-field="price">` : product.price}</td>
        <td>${isAdmin() ? `<input class="edit-input" type="number" min="0" step="1" value="${product.stock}" data-id="${product.id}" data-field="stock">` : product.stock}</td>
        <td>${isAdmin() ? `<button class="action-btn delete-product" data-id="${product.id}">Delete</button>` : ''}</td>
      `;
      productsTableBody.appendChild(tr);
    });
  }

  function renderKeys() {
    keysTableBody.innerHTML = '';
    licenseKeys.forEach(key => {
      const tr = document.createElement('tr');
      tr.innerHTML = `
        <td>${key.id}</td>
        <td>${isAdmin() ? `<input class="edit-input" type="number" min="1" value="${key.productId}" data-id="${key.id}" data-field="productId" style="width:60px;">` : key.productId}</td>
        <td>${isAdmin() ? `<input class="edit-input" type="text" value="${key.key}" data-id="${key.id}" data-field="key">` : key.key}</td>
        <td>${isAdmin() ? `<input type="checkbox" class="used-checkbox" data-id="${key.id}" ${key.used ? 'checked' : ''}/>` : (key.used ? 'Yes' : 'No')}</td>
        <td>${isAdmin() ? `<button class="action-btn delete-key" data-id="${key.id}">Delete</button>` : ''}</td>
      `;
      keysTableBody.appendChild(tr);
    });
  }

  function renderSettings() {
    document.getElementById('reseller-name').value = settings.resellerName;
    document.getElementById('reseller-email').value = settings.resellerEmail;
    document.getElementById('payment-method').value = settings.paymentMethod;

    ['reseller-name', 'reseller-email', 'payment-method'].forEach(id => {
      document.getElementById(id).disabled = !isAdmin();
    });
    document.querySelector('#settings-form input[type="submit"]').disabled = !isAdmin();
  }

  // Editing handlers
  productsTableBody.addEventListener('input', e => {
    if(!isAdmin()) return;
    if(e.target.classList.contains('edit-input')) {
      const id = Number(e.target.dataset.id);
      const field = e.target.dataset.field;
      const val = e.target.type === 'number' ? Number(e.target.value) : e.target.value;
      const product = products.find(p => p.id === id);
      if(product) {
        product[field] = val;
        saveProducts();
      }
    }
  });
  keysTableBody.addEventListener('input', e => {
    if(!isAdmin()) return;
    if(e.target.classList.contains('edit-input')) {
      const id = Number(e.target.dataset.id);
      const field = e.target.dataset.field;
      const val = e.target.type === 'number' ? Number(e.target.value) : e.target.value;
      const key = licenseKeys.find(k => k.id === id);
      if(key) {
        key[field] = val;
        saveKeys();
      }
    }
  });
  keysTableBody.addEventListener('change', e => {
    if(!isAdmin()) return;
    if(e.target.classList.contains('used-checkbox')) {
      const id = Number(e.target.dataset.id);
      const key = licenseKeys.find(k => k.id === id);
      if(key) {
        key.used = e.target.checked;
        saveKeys();
      }
    }
  });

  // Delete buttons
  productsTableBody.addEventListener('click', e => {
    if(!isAdmin()) return;
    if(e.target.classList.contains('delete-product')) {
      const id = Number(e.target.dataset.id);
      products = products.filter(p => p.id !== id);
      saveProducts();
      renderProducts();
    }
  });
  keysTableBody.addEventListener('click', e => {
    if(!isAdmin()) return;
    if(e.target.classList.contains('delete-key')) {
      const id = Number(e.target.dataset.id);
      licenseKeys = licenseKeys.filter(k => k.id !== id);
      saveKeys();
      renderKeys();
    }
  });

  // Add new product
  document.getElementById('add-product-form').addEventListener('submit', e => {
    e.preventDefault();
    if(!isAdmin()) {
      alert('Only admin can add products.');
      return;
    }
    const name = document.getElementById('product-name').value.trim();
    const price = parseFloat(document.getElementById('product-price').value);
    const stock = parseInt(document.getElementById('product-stock').value);
    if(!name || isNaN(price) || isNaN(stock)) {
      alert('Please enter valid product details.');
      return;
    }
    const newId = products.length ? Math.max(...products.map(p => p.id)) + 1 : 1;
    products.push({id: newId, name, price, stock});
    saveProducts();
    renderProducts();
    e.target.reset();
  });

  // Add new license key
  document.getElementById('add-key-form').addEventListener('submit', e => {
    e.preventDefault();
    if(!isAdmin()) {
      alert('Only admin can add license keys.');
      return;
    }
    const productId = parseInt(document.getElementById('key-product-id').value);
    const keyVal = document.getElementById('license-key').value.trim();
    const used = document.getElementById('license-used').checked;
    if(isNaN(productId) || !keyVal) {
      alert('Please enter valid license key details.');
      return;
    }
    const newId = licenseKeys.length ? Math.max(...licenseKeys.map(k => k.id)) + 1 : 1;
    licenseKeys.push({id: newId, productId, key: keyVal, used});
    saveKeys();
    renderKeys();
    e.target.reset();
  });

  // Settings form submit
  document.getElementById('settings-form').addEventListener('submit', e => {
    e.preventDefault();
    if(!isAdmin()) {
      alert('Only admin can save settings.');
      return;
    }
    settings.resellerName = document.getElementById('reseller-name').value.trim();
    settings.resellerEmail = document.getElementById('reseller-email').value.trim();
    settings.paymentMethod = document.getElementById('payment-method').value.trim();
    saveSettings();
    alert('Settings saved.');
  });

  // Auth buttons & modals
  const resellerLoginBtn = document.getElementById('reseller-login-btn');
  const resellerSignupBtn = document.getElementById('reseller-signup-btn');
  const adminLoginBtn = document.getElementById('admin-login-btn');

  const resellerLoginModal = document.getElementById('reseller-login-modal');
  const resellerSignupModal = document.getElementById('reseller-signup-modal');
  const adminLoginModal = document.getElementById('admin-login-modal');

  const resellerLoginClose = document.getElementById('reseller-login-close');
  const resellerSignupClose = document.getElementById('reseller-signup-close');
  const adminLoginClose = document.getElementById('admin-login-close');

  resellerLoginBtn.onclick = () => resellerLoginModal.classList.add('active');
  resellerSignupBtn.onclick = () => resellerSignupModal.classList.add('active');
  adminLoginBtn.onclick = () => adminLoginModal.classList.add('active');

  resellerLoginClose.onclick = () => resellerLoginModal.classList.remove('active');
  resellerSignupClose.onclick = () => resellerSignupModal.classList.remove('active');
  adminLoginClose.onclick = () => adminLoginModal.classList.remove('active');

  // Show switch between reseller login/signup in modals
  document.getElementById('show-reseller-signup').onclick = () => {
    resellerLoginModal.classList.remove('active');
    resellerSignupModal.classList.add('active');
  };
  document.getElementById('show-reseller-login').onclick = () => {
    resellerSignupModal.classList.remove('active');
    resellerLoginModal.classList.add('active');
  };

  // Reseller sign up form
  document.getElementById('reseller-signup-form').addEventListener('submit', e => {
    e.preventDefault();
    const username = document.getElementById('reseller-signup-username').value.trim();
    const password = document.getElementById('reseller-signup-password').value.trim();
    if(!username || !password) {
      alert('Enter username and password.');
      return;
    }
    if(resellers.find(u => u.username === username)) {
      alert('Username taken.');
      return;
    }
    resellers.push({username, password});
    saveResellers();
    alert('Account created! Please login.');
    resellerSignupModal.classList.remove('active');
    resellerLoginModal.classList.add('active');
    e.target.reset();
  });

  // Reseller login form
  document.getElementById('reseller-login-form').addEventListener('submit', e => {
    e.preventDefault();
    const username = document.getElementById('reseller-login-username').value.trim();
    const password = document.getElementById('reseller-login-password').value.trim();
    const user = resellers.find(u => u.username === username && u.password === password);
    if(!user) {
      alert('Invalid reseller credentials.');
      return;
    }
    currentUser = user;
    saveCurrentUser();
    alert('Logged in as reseller: ' + username);
    resellerLoginModal.classList.remove('active');
    updateUI();
  });

  // Admin login form
  document.getElementById('admin-login-form').addEventListener('submit', e => {
    e.preventDefault();
    const username = document.getElementById('admin-login-username').value.trim();
    const password = document.getElementById('admin-login-password').value.trim();
    if(username === ADMIN_CREDENTIALS.username && password === ADMIN_CREDENTIALS.password) {
      adminUser = {username};
      saveAdminUser();
      alert('Admin logged in!');
      adminLoginModal.classList.remove('active');
      updateUI();
    } else {
      alert('Invalid admin credentials.');
    }
  });

  // Logout button
  function addLogoutBtn() {
    const authDiv = document.getElementById('auth-buttons');
    authDiv.innerHTML = '';
    if(isAdmin()) {
      authDiv.innerHTML = `<span style="color:#5af; font-weight:700; margin-right:10px;">Admin: ${adminUser.username}</span><button id="logout-btn">Logout</button>`;
      document.getElementById('logout-btn').onclick = () => {
        adminUser = null;
        saveAdminUser();
        updateUI();
      };
    } else if(isReseller()) {
      authDiv.innerHTML = `<span style="color:#5af; font-weight:700; margin-right:10px;">Reseller: ${currentUser.username}</span><button id="logout-btn">Logout</button>`;
      document.getElementById('logout-btn').onclick = () => {
        currentUser = null;
        saveCurrentUser();
        updateUI();
      };
    } else {
      authDiv.innerHTML = `
        <button id="reseller-login-btn">Reseller Login</button>
        <button id="reseller-signup-btn">Reseller Sign Up</button>
        <button id="admin-login-btn">Admin Login</button>
      `;
      // Rebind buttons
      document.getElementById('reseller-login-btn').onclick = () => resellerLoginModal.classList.add('active');
      document.getElementById('reseller-signup-btn').onclick = () => resellerSignupModal.classList.add('active');
      document.getElementById('admin-login-btn').onclick = () => adminLoginModal.classList.add('active');
    }
  }

  // Update UI depending on role
  function updateUI() {
    addLogoutBtn();

    if(isAdmin()) {
      document.body.classList.remove('view-only');
      document.getElementById('add-product-form').style.display = 'block';
      document.getElementById('add-key-form').style.display = 'block';
    } else {
      // Reseller or nobody: view only
      document.body.classList.add('view-only');
      document.getElementById('add-product-form').style.display = 'none';
      document.getElementById('add-key-form').style.display = 'none';
    }
    renderProducts();
    renderKeys();
    renderSettings();
  }

  updateUI();

</script>
</body>
</html>
